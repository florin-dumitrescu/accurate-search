class AccurateSearch{c;w;s;i;constructor(e){this.c=[],this.w={},this.s=!1,this.i=!0,e&&(e.engine&&"speed"===e.engine&&(this.s=!0),void 0!==e.insideWords&&!1===e.insideWords&&(this.i=!1))}search(e){let t=e.toLowerCase(),s=v(e).split(" ");if(this.s){let e={};for(let t of s){let s=this.w[t];if(s)for(let t of s)e[t]||(e[t]=0),e[t]+=5;for(let s in this.w){let i=s.indexOf(t);if(0===i){let t=this.w[s];for(let s of t)e[s]||(e[s]=0),e[s]+=2}else if(this.i&&i>0){let t=this.w[s];for(let s of t)e[s]||(e[s]=0),e[s]+=1}}}let t={};for(let s in e){let i=e[s];t[i]||(t[i]=[]),t[i].push(s)}let i=[];for(let e in t)i=t[e].concat(i);return i}{let e=" "+t,i=t+" ",l=[],h=[],f=[],r=[],o=[],n=[],c=[],p=[],a=[];for(let d=0;d<this.c.length;d++){let g=this.c[d].i,w=this.c[d].t,x=this.c[d].w;if(w===t)l.push(g);else if(w.startsWith(i))h.push(g);else if(w.startsWith(t))f.push(g);else if(1===s.length){let e=u(s,x,this.i);e>0&&(3===e?n.push(g):2===e?c.push(g):1===e&&p.push(g))}else if(w.indexOf(e)>=0)r.push(g);else if(this.i&&w.indexOf(t)>=0)o.push(g);else{let e=u(s,x,this.i);e>0&&a.push({s:e,i:g})}}let d=l.concat(h,f,r,o);if(1===s.length)d=d.concat(n,c,p);else{a.sort((e,t)=>t.s-e.s);for(let e of a)d.push(e.i)}return d}}suggestions(e,t){let s=[];for(let i of this.c){let l=i.t;if(l.length>e.length){let t=l.indexOf(e);if(t>=0){let i=l.indexOf(" ",t+e.length+1);l=i>0?l.substr(t,i-t):l.substr(t),l.length>e.length&&!s.includes(l)&&s.push(l)}}if(s.length>=t)break}return s.sort((e,t)=>e.length-t.length),s}addText(e,t,s){if(t){let i=v(t),l={i:e,t:i,l:t.length};if(s&&(l.r=s),this.s){this.c.push(l);let t=i.split(" ");for(let s of t)s&&(this.w[s]||(this.w[s]=[]),this.w[s].push(e))}else l.w=i.split(" "),y(l,this.c)}}remove(e){}}function u(e,t,s){let i=0;if(s)for(let s of e)if(t.indexOf(s)>=0)i+=3;else{let e=0;for(let i of t){let t=i.indexOf(s);if(0===t){e=2;break}t>0&&(e=1)}i+=e}else for(let s of e)if(t.indexOf(s)>=0)i+=3;else{let e=0;for(let i of t)if(i.startsWith(s)){e=2;break}i+=e}return i}function v(e){return e.toLowerCase().replace(/[`~!@$%^*()_|=?;:",\.<>\{\}\[\]\\\/]/g," ").trim()}function y(e,t,s,i){var l=t.length,h=void 0!==s?s:0,f=void 0!==i?i:l-1,r=h+Math.floor((f-h)/2);0!=l?p(e,t[f])>=0?t.splice(f+1,0,e):p(e,t[h])<=0?t.splice(h,0,e):h>=f?t.splice(h,0,e):p(e,t[r])<=0?y(e,t,h,r-1):y(e,t,r+1,f):t.push(e)}function p(e,t){return e.r?t.r?e.r-t.r:1:t.r?-1:e.l-t.l}module.exports=AccurateSearch;