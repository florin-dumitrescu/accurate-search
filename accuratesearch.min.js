class AccurateSearch{c;w;s;i;constructor(t){this.c=[],this.w={},this.s=!1,this.i=!0,t&&(t.engine&&"speed"===t.engine&&(this.s=!0),void 0!==t.insideWords&&!1===t.insideWords&&(this.i=!1))}search(t){let e=t.toLowerCase(),i=v(t).split(" ");if(this.s){let t={};for(let e of i){let i=this.w[e];if(i)for(let e of i)t[e]||(t[e]=0),t[e]+=5;for(let i in this.w){let s=i.indexOf(e);if(0===s){let e=this.w[i];for(let i of e)t[i]||(t[i]=0),t[i]+=2}else if(this.i&&s>0){let e=this.w[i];for(let i of e)t[i]||(t[i]=0),t[i]+=1}}}let e={};for(let i in t){let s=t[i];e[s]||(e[s]=[]),e[s].push(i)}let s=[];for(let t in e)s=e[t].concat(s);return s}{let t=" "+e,s=e+" ",l=[],h=[],r=[],f=[],o=[],n=[],c=[],p=[],a=[];for(let d=0;d<this.c.length;d++){let g=this.c[d],w=g.i,x=g.t,v=g.w;if(x===e)l.push(w);else if(x.startsWith(s))h.push(w);else if(x.startsWith(e))r.push(w);else if(1===i.length){let t=u(i,v,this.i);t>0&&(3===t?n.push(w):2===t?c.push(w):1===t&&p.push(w))}else if(x.indexOf(t)>=0)f.push(w);else if(this.i&&x.indexOf(e)>=0)o.push(w);else{let t=u(i,v,this.i);t>0&&a.push({s:t,i:w})}}let d=l.concat(h,r,f,o);if(1===i.length)d=d.concat(n,c,p);else{a.sort((t,e)=>e.s-t.s);for(let t of a)d.push(t.i)}return d}}suggestions(t,e){let i=[];for(let s of this.c){let l=s.t;if(l.length>t.length){let e=l.indexOf(t);if(e>=0&&(0===e||" "===l.charAt(e-1))){let s=l.indexOf(" ",e+t.length+1);l=s>0?l.substr(e,s-e):l.substr(e),l.length>t.length&&!i.includes(l)&&i.push(l)}}if(i.length>=e)break}return i.sort((t,e)=>t.length-e.length),i}addText(t,e,i){if(e){let s=v(e),l={i:t,t:s,l:e.length};if(i&&(l.r=i),this.s){this.c.push(l);let e=s.split(" ");for(let i of e)i&&(this.w[i]||(this.w[i]=[]),this.w[i].push(t))}else l.w=s.split(" "),y(l,this.c)}}remove(t){for(let e=0;e<this.c.length;e++)this.c[e].i===t&&this.c.splice(e,1);for(let e in this.w){for(let i=0;i<this.w[e].length;i++)this.w[e][i]===t&&this.w[e].splice(i,1);0==this.w[e].length&&delete this.w[e]}}}function u(t,e,i){let s=0;if(i)for(let i of t)if(e.indexOf(i)>=0)s+=3;else{let t=0;for(let s of e){let e=s.indexOf(i);if(0===e){t=2;break}e>0&&(t=1)}s+=t}else for(let i of t)if(e.indexOf(i)>=0)s+=3;else{let t=0;for(let s of e)if(s.startsWith(i)){t=2;break}s+=t}return s}function v(t){return t.toLowerCase().replace(/[`~!@$%^*()_|=?;:",\.<>\{\}\[\]\\\/]/g," ").trim()}function y(t,e,i,s){var l=e.length,h=void 0!==i?i:0,r=void 0!==s?s:l-1,f=h+Math.floor((r-h)/2);0!=l?p(t,e[r])>=0?e.splice(r+1,0,t):p(t,e[h])<=0?e.splice(h,0,t):h>=r?e.splice(h,0,t):p(t,e[f])<=0?y(t,e,h,f-1):y(t,e,f+1,r):e.push(t)}function p(t,e){return t.r?e.r?e.r-t.r:-1:e.r?1:t.l-e.l}module.exports=AccurateSearch;